{% extends "base.html" %}

{% block container %}Sites Analysis{% endblock %}

{% block content %}
<script src="//cdn.amcharts.com/lib/4/core.js"></script>
<script src="//cdn.amcharts.com/lib/4/charts.js"></script>
<script src="//cdn.amcharts.com/lib/4/themes/animated.js"></script>
<div id="chartdiv" style="width: 130%; height: 60%; margin-left: -15%; margin-top: 0%;" ></div>
<div id="piechart1" class="asset"></div>
<div id="piechart2" class="asset"></div>
<div id="piechart3" class="asset"></div>
<div id="piechart4" class="asset"></div>
<div id="piechart5" class="asset"></div>
<div id="piechart6" class="asset"></div>
<div id="piechart7" class="asset"></div>
<div id="piechart8" class="asset"></div>
<div id="piechart9" class="asset"></div>
<div id="piechart10" class="asset"></div>

<script>
am4core.useTheme(am4themes_animated);

var data = [{'website': 'newsit.gr', 'articles': 1868, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 0, 'topic': 'Culture'}, {'count': 300, 'topic': 'Society'}, {'count': 300, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 68, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 300, 'topic': 'Style'}]}, {'website': 'sport24.gr', 'articles': 268, 'pie': [{'count': 0, 'topic': 'World'}, {'count': 268, 'topic': 'Sport'}, {'count': 0, 'topic': 'Culture'}, {'count': 0, 'topic': 'Society'}, {'count': 0, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 0, 'topic': 'Politics'}, {'count': 0, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'gazzetta.gr', 'articles': 300, 'pie': [{'count': 0, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 0, 'topic': 'Culture'}, {'count': 0, 'topic': 'Society'}, {'count': 0, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 0, 'topic': 'Politics'}, {'count': 0, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'topontiki.gr', 'articles': 1861, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 289, 'topic': 'Sport'}, {'count': 288, 'topic': 'Culture'}, {'count': 262, 'topic': 'Society'}, {'count': 271, 'topic': 'Economics'}, {'count': 187, 'topic': 'Environment'}, {'count': 264, 'topic': 'Politics'}, {'count': 0, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'insomnia.gr', 'articles': 287, 'pie': [{'count': 0, 'topic': 'World'}, {'count': 0, 'topic': 'Sport'}, {'count': 0, 'topic': 'Culture'}, {'count': 0, 'topic': 'Society'}, {'count': 0, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 0, 'topic': 'Politics'}, {'count': 287, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'periodista.gr', 'articles': 1491, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 296, 'topic': 'Sport'}, {'count': 0, 'topic': 'Culture'}, {'count': 299, 'topic': 'Society'}, {'count': 300, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 296, 'topic': 'Politics'}, {'count': 0, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'tovima.gr', 'articles': 2213, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 279, 'topic': 'Sport'}, {'count': 328, 'topic': 'Culture'}, {'count': 264, 'topic': 'Society'}, {'count': 258, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 268, 'topic': 'Politics'}, {'count': 236, 'topic': 'Tech'}, {'count': 280, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'thetoc.gr', 'articles': 2100, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 300, 'topic': 'Culture'}, {'count': 300, 'topic': 'Society'}, {'count': 300, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 0, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 300, 'topic': 'Style'}]}, {'website': 'tanea.gr', 'articles': 2373, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 381, 'topic': 'Culture'}, {'count': 300, 'topic': 'Society'}, {'count': 300, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 300, 'topic': 'Tech'}, {'count': 117, 'topic': 'Food'}, {'count': 75, 'topic': 'Style'}]}, {'website': 'kathimerini.gr', 'articles': 2007, 'pie': [{'count': 282, 'topic': 'World'}, {'count': 251, 'topic': 'Sport'}, {'count': 239, 'topic': 'Culture'}, {'count': 235, 'topic': 'Society'}, {'count': 0, 'topic': 'Economics'}, {'count': 164, 'topic': 'Environment'}, {'count': 254, 'topic': 'Politics'}, {'count': 285, 'topic': 'Tech'}, {'count': 297, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'lifo.gr', 'articles': 2400, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 0, 'topic': 'Sport'}, {'count': 300, 'topic': 'Culture'}, {'count': 300, 'topic': 'Society'}, {'count': 0, 'topic': 'Economics'}, {'count': 300, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 300, 'topic': 'Tech'}, {'count': 300, 'topic': 'Food'}, {'count': 300, 'topic': 'Style'}]}, {'website': 'iefimerida.gr', 'articles': 2387, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 118, 'topic': 'Sport'}, {'count': 202, 'topic': 'Culture'}, {'count': 300, 'topic': 'Society'}, {'count': 184, 'topic': 'Economics'}, {'count': 217, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 300, 'topic': 'Tech'}, {'count': 166, 'topic': 'Food'}, {'count': 300, 'topic': 'Style'}]}, {'website': 'efsyn.gr', 'articles': 1380, 'pie': [{'count': 295, 'topic': 'World'}, {'count': 0, 'topic': 'Sport'}, {'count': 269, 'topic': 'Culture'}, {'count': 225, 'topic': 'Society'}, {'count': 300, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 291, 'topic': 'Politics'}, {'count': 0, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'newpost.gr', 'articles': 2572, 'pie': [{'count': 299, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 322, 'topic': 'Culture'}, {'count': 292, 'topic': 'Society'}, {'count': 285, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 290, 'topic': 'Politics'}, {'count': 285, 'topic': 'Tech'}, {'count': 251, 'topic': 'Food'}, {'count': 248, 'topic': 'Style'}]}, {'website': 'cnn.gr', 'articles': 2686, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 286, 'topic': 'Culture'}, {'count': 300, 'topic': 'Society'}, {'count': 300, 'topic': 'Economics'}, {'count': 300, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 300, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 300, 'topic': 'Style'}]}, {'website': 'popaganda.gr', 'articles': 1816, 'pie': [{'count': 295, 'topic': 'World'}, {'count': 245, 'topic': 'Sport'}, {'count': 200, 'topic': 'Culture'}, {'count': 299, 'topic': 'Society'}, {'count': 0, 'topic': 'Economics'}, {'count': 207, 'topic': 'Environment'}, {'count': 0, 'topic': 'Politics'}, {'count': 270, 'topic': 'Tech'}, {'count': 300, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'protagon.gr', 'articles': 1933, 'pie': [{'count': 0, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 300, 'topic': 'Culture'}, {'count': 300, 'topic': 'Society'}, {'count': 300, 'topic': 'Economics'}, {'count': 133, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 300, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'reader.gr', 'articles': 1499, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 0, 'topic': 'Culture'}, {'count': 299, 'topic': 'Society'}, {'count': 300, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 0, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'naftemporiki.gr', 'articles': 2196, 'pie': [{'count': 300, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 300, 'topic': 'Culture'}, {'count': 300, 'topic': 'Society'}, {'count': 96, 'topic': 'Economics'}, {'count': 300, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 300, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 0, 'topic': 'Style'}]}, {'website': 'in.gr', 'articles': 2100, 'pie': [{'count': 0, 'topic': 'World'}, {'count': 300, 'topic': 'Sport'}, {'count': 300, 'topic': 'Culture'}, {'count': 300, 'topic': 'Society'}, {'count': 300, 'topic': 'Economics'}, {'count': 0, 'topic': 'Environment'}, {'count': 300, 'topic': 'Politics'}, {'count': 300, 'topic': 'Tech'}, {'count': 0, 'topic': 'Food'}, {'count': 300, 'topic': 'Style'}]}];

// Create chart instance
var chart = am4core.create("chartdiv", am4charts.XYChart);
chart.hiddenState.properties.opacity = 0; // this creates initial fade-in

// Add data
chart.data = data;

// Create axes
var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
categoryAxis.dataFields.category = "website";
categoryAxis.renderer.labels.template.rotation = 270;
categoryAxis.renderer.labels.template.hideOversized = false;
categoryAxis.renderer.minGridDistance = 20;
categoryAxis.renderer.labels.template.horizontalCenter = "right";
categoryAxis.renderer.labels.template.verticalCenter = "middle";
categoryAxis.tooltip.label.rotation = 270;
categoryAxis.tooltip.label.horizontalCenter = "right";
categoryAxis.tooltip.label.verticalCenter = "middle";

var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
valueAxis.title.text = "Articles counted";
valueAxis.min = 0;
valueAxis.renderer.baseGrid.disabled = true;
valueAxis.renderer.grid.template.strokeOpacity = 0.07;

// Create series
var series = chart.series.push(new am4charts.ColumnSeries());
series.dataFields.valueY = "articles";
series.dataFields.categoryX = "website";
series.tooltip.pointerOrientation = "vertical";
series.tooltip.dy = -8;


var columnTemplate = series.columns.template;
// add tooltip on column, not template, so that slices could also have tooltip
columnTemplate.column.tooltipText = "Series: {name}\nCategory: {categoryX}\nValue: {valueY}";
columnTemplate.column.tooltipY = 0;
columnTemplate.column.cornerRadiusTopLeft = 20;
columnTemplate.column.cornerRadiusTopRight = 20;
columnTemplate.strokeOpacity = 0;


// as by default columns of the same series are of the same color, we add adapter which takes colors from chart.colors color set
columnTemplate.adapter.add("fill", (fill, target) => {	
	var color = chart.colors.getIndex(target.dataItem.index * 3);
	return color;
});

// create pie chart as a column child
var pieChart = series.columns.template.createChild(am4charts.PieChart);
pieChart.width = am4core.percent(90);
pieChart.height = am4core.percent(90);
pieChart.align = "center";
pieChart.valign = "middle";
pieChart.dataFields.data = "pie";

var pieSeries = pieChart.series.push(new am4charts.PieSeries());
pieSeries.dataFields.value = "count";
pieSeries.dataFields.category = "topic";
pieSeries.labels.template.disabled = true;
pieSeries.ticks.template.disabled = true;
pieSeries.slices.template.stroke = am4core.color("#ffffff");
pieSeries.slices.template.strokeWidth = 1;
pieSeries.slices.template.strokeOpacity = 0;

pieSeries.slices.template.adapter.add("fill", (fill, target)=>{
  return am4core.color("#ffffff")
});

pieSeries.slices.template.adapter.add("fillOpacity", (fillOpacity, target)=>{
  return (target.dataItem.index + 1) * 0.08;
});

pieSeries.hiddenState.properties.startAngle = -90;
pieSeries.hiddenState.properties.endAngle = 270;
</script>

{% endblock %}
